{"version":3,"sources":["../src/utils/x402.ts","../src/utils/axllm.ts","../src/config.ts","../src/utils/utils.ts"],"names":["DEFAULT_PROVIDER","DEFAULT_MODEL"],"mappings":"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","file":"utils.js","sourcesContent":["import { ai } from \"@ax-llm/ax\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { wrapFetchWithPayment, type Hex } from \"x402-fetch\";\n\nconst DEFAULT_MODEL = \"gpt-5\";\nconst DEFAULT_PROVIDER = \"openai\";\nconst DEFAULT_API_URL = \"http://localhost:3030/v1\";\n\ntype WrappedFetch = typeof fetch & {\n  preconnect?: () => Promise<void>;\n};\n\nexport type X402Account = Parameters<typeof wrapFetchWithPayment>[1];\n\nexport type CreateX402FetchOptions = {\n  account: X402Account;\n  fetchImpl?: typeof fetch;\n};\n\nexport const createX402Fetch = ({\n  account,\n  fetchImpl,\n}: CreateX402FetchOptions): WrappedFetch => {\n  if (!account) {\n    throw new Error(\"[agent-kit] createX402Fetch requires an account\");\n  }\n  const paymentFetch = wrapFetchWithPayment(\n    (fetchImpl ?? fetch) as Parameters<typeof wrapFetchWithPayment>[0],\n    account\n  ) as WrappedFetch;\n\n  return Object.assign(\n    (input: Parameters<typeof fetch>[0], init?: Parameters<typeof fetch>[1]) =>\n      paymentFetch(input, init ?? {}),\n    {\n      preconnect: paymentFetch.preconnect ?? (async () => {}),\n    }\n  );\n};\n\nexport const accountFromPrivateKey = (privateKey: Hex): X402Account => {\n  if (!privateKey || privateKey.trim().length === 0) {\n    throw new Error(\n      \"[agent-kit] accountFromPrivateKey requires a non-empty private key\"\n    );\n  }\n  return privateKeyToAccount(privateKey) as X402Account;\n};\n\ntype AiFactoryArgs = Parameters<typeof ai>[0];\ntype AiFactoryConfig = NonNullable<AiFactoryArgs[\"config\"]>;\ntype AiFactoryOptions = NonNullable<AiFactoryArgs[\"options\"]>;\n\nexport type CreateX402LLMOptions = {\n  account?: X402Account;\n  privateKey?: Hex;\n  fetch?: WrappedFetch;\n  fetchImpl?: typeof fetch;\n  model?: string;\n  ai?:\n    | (Record<string, unknown> & {\n        options?: Partial<AiFactoryOptions>;\n        config?: Partial<AiFactoryConfig>;\n      })\n    | undefined;\n};\n\nexport const createX402LLM = (\n  options: CreateX402LLMOptions = {}\n): ReturnType<typeof ai> => {\n  const account =\n    options.account ??\n    (options.privateKey\n      ? accountFromPrivateKey(options.privateKey)\n      : undefined);\n\n  if (!account) {\n    throw new Error(\n      \"[agent-kit] createX402LLM requires either an account or a private key\"\n    );\n  }\n\n  const paymentFetch =\n    options.fetch ?? createX402Fetch({ account, fetchImpl: options.fetchImpl });\n\n  const aiOverrides = options.ai ?? {};\n  const {\n    config: configOverridesRaw,\n    options: optionOverridesRaw,\n    apiKey: apiKeyOverrideRaw,\n    apiURL: apiUrlOverrideRaw,\n    name: nameOverrideRaw,\n    ...restAiProps\n  } = aiOverrides;\n\n  const configOverrides =\n    configOverridesRaw && typeof configOverridesRaw === \"object\"\n      ? (configOverridesRaw as Partial<AiFactoryConfig>)\n      : undefined;\n  const optionOverrides =\n    optionOverridesRaw && typeof optionOverridesRaw === \"object\"\n      ? (optionOverridesRaw as Partial<AiFactoryOptions>)\n      : undefined;\n  const explicitApiKey =\n    typeof apiKeyOverrideRaw === \"string\" && apiKeyOverrideRaw.trim().length > 0\n      ? apiKeyOverrideRaw\n      : undefined;\n  const nameOverride =\n    typeof nameOverrideRaw === \"string\" && nameOverrideRaw.trim().length > 0\n      ? nameOverrideRaw\n      : undefined;\n  const apiUrlOverride =\n    typeof apiUrlOverrideRaw === \"string\" && apiUrlOverrideRaw.trim().length > 0\n      ? apiUrlOverrideRaw\n      : undefined;\n\n  const apiKey = (explicitApiKey ?? process.env.OPENAI_API_KEY) as\n    | string\n    | undefined;\n\n  if (!apiKey) {\n    throw new Error(\n      \"[agent-kit] createX402LLM requires an OpenAI API key (set options.ai.apiKey or OPENAI_API_KEY)\"\n    );\n  }\n\n  const baseConfig: AiFactoryConfig = {\n    stream: true,\n    model: options.model ?? DEFAULT_MODEL,\n  };\n\n  const finalConfig = {\n    ...baseConfig,\n    ...(configOverrides ?? {}),\n  } as AiFactoryConfig;\n\n  const finalOptions = {\n    ...(optionOverrides ?? {}),\n    fetch: paymentFetch,\n  } as AiFactoryOptions;\n\n  const aiArgs = {\n    ...restAiProps,\n    name: nameOverride ?? DEFAULT_PROVIDER,\n    apiKey,\n    apiURL: apiUrlOverride ?? DEFAULT_API_URL,\n    config: finalConfig,\n    options: finalOptions,\n  } as AiFactoryArgs;\n\n  return ai(aiArgs);\n};\n\nexport const x402LLM = ({\n  privateKey = process.env.PRIVATE_KEY as Hex,\n  model = DEFAULT_MODEL,\n  apiURL = DEFAULT_API_URL,\n}: {\n  privateKey: Hex;\n  model?: string;\n  apiURL?: string;\n}) =>\n  createX402LLM({\n    privateKey,\n    model,\n    ai: { apiURL },\n  });\n","import { createX402LLM, type CreateX402LLMOptions } from \"./x402\";\nimport type { Hex } from \"viem\";\n\nexport type AxLLMClientOptions = {\n  provider?: string;\n  model?: string;\n  apiKey?: string;\n  temperature?: number;\n  debug?: boolean;\n  env?: Record<string, string | undefined>;\n  client?: ReturnType<typeof createX402LLM>;\n  clientFactory?: () => ReturnType<typeof createX402LLM> | null;\n  x402?: CreateX402LLMOptions;\n  logger?: {\n    warn?: (message: string, error?: unknown) => void;\n  };\n};\n\nexport type AxLLMClient = {\n  ax: ReturnType<typeof createX402LLM> | null;\n  isConfigured(): boolean;\n};\n\nconst DEFAULT_PROVIDER = \"openai\";\nconst DEFAULT_MODEL = \"gpt-5\";\n\nexport function createAxLLMClient(\n  options: AxLLMClientOptions = {}\n): AxLLMClient {\n  const resolved = resolveOptions(options);\n  const logger = options.logger;\n\n  const axInstance = (() => {\n    if (options.client) return options.client;\n\n    const fromFactory = options.clientFactory?.();\n    if (fromFactory) return fromFactory;\n\n    try {\n      return createX402LLM(buildCreateOptions(resolved, options.x402));\n    } catch (error) {\n      logger?.warn?.(\n        `[agent-kit] failed to initialise Ax LLM client: ${\n          (error as Error).message\n        }`,\n        error\n      );\n      return null;\n    }\n  })();\n\n  return {\n    ax: axInstance,\n    isConfigured() {\n      return Boolean(axInstance);\n    },\n  };\n}\n\nfunction resolveOptions(options: AxLLMClientOptions) {\n  const env = readEnv(options.env);\n\n  const provider =\n    options.provider ??\n    env.AX_PROVIDER ??\n    env.AXLLM_PROVIDER ??\n    env.OPENAI_PROVIDER ??\n    DEFAULT_PROVIDER;\n\n  const model =\n    options.model ??\n    env.AX_MODEL ??\n    env.AXLLM_MODEL ??\n    env.OPENAI_MODEL ??\n    DEFAULT_MODEL;\n\n  const apiKey = options.apiKey ?? env.OPENAI_API_KEY;\n\n  const temperature =\n    options.temperature ??\n    parseNumber(\n      env.AX_TEMPERATURE ?? env.AXLLM_TEMPERATURE ?? env.OPENAI_TEMPERATURE\n    );\n\n  const debug =\n    options.debug ?? parseBoolean(env.AX_DEBUG ?? env.AXLLM_DEBUG) ?? false;\n\n  return { provider, model, apiKey, temperature, debug };\n}\n\nfunction buildCreateOptions(\n  resolved: ReturnType<typeof resolveOptions>,\n  overrides: CreateX402LLMOptions | undefined\n): CreateX402LLMOptions {\n  const x402 = overrides ? { ...overrides } : {};\n  const aiOverrides = overrides?.ai ? { ...overrides.ai } : {};\n  const aiConfigOverrides =\n    aiOverrides.config && typeof aiOverrides.config === \"object\"\n      ? { ...aiOverrides.config }\n      : undefined;\n  const aiOptionOverrides =\n    aiOverrides.options && typeof aiOverrides.options === \"object\"\n      ? { ...aiOverrides.options }\n      : undefined;\n\n  const finalTemperature =\n    aiConfigOverrides && \"temperature\" in aiConfigOverrides\n      ? aiConfigOverrides.temperature\n      : resolved.temperature;\n\n  const finalConfig = {\n    stream: true,\n    model: aiConfigOverrides?.model ?? x402.model ?? resolved.model,\n    ...(aiConfigOverrides ?? {}),\n    ...(finalTemperature !== undefined\n      ? { temperature: finalTemperature }\n      : {}),\n  };\n\n  const finalOptions = {\n    ...(aiOptionOverrides ?? {}),\n    ...(resolved.debug ? { debug: resolved.debug } : {}),\n  };\n\n  const apiKey =\n    aiOverrides.apiKey ??\n    resolved.apiKey ??\n    (typeof process !== \"undefined\" ? process.env.OPENAI_API_KEY : undefined);\n\n  if (!apiKey) {\n    throw new Error(\n      \"[agent-kit] createAxLLMClient requires an OpenAI API key (set apiKey or OPENAI_API_KEY)\"\n    );\n  }\n\n  const name = aiOverrides.name ?? resolved.provider;\n\n  const finalAi = {\n    ...aiOverrides,\n    name,\n    apiKey,\n    config: finalConfig,\n    options: finalOptions,\n  } as NonNullable<CreateX402LLMOptions[\"ai\"]>;\n\n  const createOptions: CreateX402LLMOptions = {\n    ...x402,\n    model: x402.model ?? resolved.model,\n    ai: finalAi,\n  };\n\n  if (!createOptions.account && !createOptions.privateKey) {\n    const envPrivateKey =\n      typeof process !== \"undefined\"\n        ? (process.env.PRIVATE_KEY as Hex | undefined)\n        : undefined;\n    if (envPrivateKey) {\n      createOptions.privateKey = envPrivateKey;\n    }\n  }\n\n  return createOptions;\n}\n\nfunction readEnv(\n  env: Record<string, string | undefined> | undefined\n): Record<string, string | undefined> {\n  if (env) return env;\n  if (typeof process !== \"undefined\" && process?.env) {\n    return process.env as Record<string, string | undefined>;\n  }\n  return {};\n}\n\nfunction parseBoolean(value: string | undefined): boolean | undefined {\n  if (value === undefined) return undefined;\n  if (value.trim() === \"\") return undefined;\n  return [\"1\", \"true\", \"yes\", \"on\"].includes(value.toLowerCase());\n}\n\nfunction parseNumber(value: string | undefined): number | undefined {\n  if (value === undefined) return undefined;\n  const numeric = Number.parseFloat(value);\n  return Number.isFinite(numeric) ? numeric : undefined;\n}\n","import type { Network, Resource, SolanaAddress } from \"x402-hono\";\n\nexport type PaymentDefaultsConfig = {\n  facilitatorUrl?: Resource;\n  payTo?: `0x${string}` | SolanaAddress;\n  network?: Network;\n  defaultPrice?: string;\n};\n\nexport type WalletConfig = {\n  apiBaseUrl?: string;\n  maxPaymentBaseUnits?: bigint;\n  maxPaymentUsd?: number;\n};\n\nexport type AgentKitConfig = {\n  payments?: PaymentDefaultsConfig;\n  wallet?: WalletConfig;\n};\n\nexport type ResolvedAgentKitConfig = {\n  payments: {\n    facilitatorUrl: Resource;\n    payTo: `0x${string}` | SolanaAddress;\n    network: Network;\n    defaultPrice?: string;\n  };\n  wallet: {\n    apiBaseUrl: string;\n    maxPaymentBaseUnits?: bigint;\n    maxPaymentUsd?: number;\n  };\n};\n\nconst DEFAULT_FACILITATOR_URL =\n  \"https://facilitator.daydreams.systems\" as Resource;\nconst DEFAULT_PAYMENT_WALLET_ADDRESS =\n  \"0xb308ed39d67D0d4BAe5BC2FAEF60c66BBb6AE429\";\nconst DEFAULT_NETWORK = \"base-sepolia\" as Network;\nconst DEFAULT_AGENT_API_BASE_URL = \"http://localhost:8787\";\n\nconst defaultConfig: ResolvedAgentKitConfig = {\n  payments: {\n    facilitatorUrl: DEFAULT_FACILITATOR_URL,\n    payTo: DEFAULT_PAYMENT_WALLET_ADDRESS,\n    network: DEFAULT_NETWORK,\n    defaultPrice: undefined,\n  },\n  wallet: {\n    apiBaseUrl: DEFAULT_AGENT_API_BASE_URL,\n    maxPaymentBaseUnits: undefined,\n    maxPaymentUsd: undefined,\n  },\n};\n\nfunction parseBigIntEnv(value: string | undefined): bigint | undefined {\n  if (!value) return undefined;\n  try {\n    const parsed = BigInt(value);\n    return parsed > 0n ? parsed : undefined;\n  } catch {\n    return undefined;\n  }\n}\n\nfunction parseNumberEnv(value: string | undefined): number | undefined {\n  if (!value) return undefined;\n  const numeric = Number(value);\n  if (!Number.isFinite(numeric) || numeric <= 0) return undefined;\n  return numeric;\n}\n\nconst environmentConfig: AgentKitConfig = {\n  payments: {\n    facilitatorUrl: process.env.FACILITATOR_URL as Resource | undefined,\n    payTo: process.env.ADDRESS as `0x${string}` | SolanaAddress | undefined,\n    network: process.env.NETWORK as Network | undefined,\n    defaultPrice: process.env.DEFAULT_PRICE ?? undefined,\n  },\n  wallet: {\n    apiBaseUrl:\n      process.env.LUCID_API_URL ?? process.env.VITE_API_URL ?? undefined,\n    maxPaymentBaseUnits: parseBigIntEnv(\n      process.env.AGENT_WALLET_MAX_PAYMENT_BASE_UNITS\n    ),\n    maxPaymentUsd: parseNumberEnv(process.env.AGENT_WALLET_MAX_PAYMENT_USDC),\n  },\n};\n\nlet runtimeOverrides: AgentKitConfig = {};\n\nfunction assignDefined<T extends Record<string, any>>(\n  target: T,\n  source: Partial<T> | undefined\n) {\n  if (!source) return;\n  for (const [key, value] of Object.entries(source)) {\n    if (value !== undefined) {\n      target[key as keyof T] = value as T[keyof T];\n    }\n  }\n}\n\nfunction applyOverrides(\n  base: ResolvedAgentKitConfig,\n  overrides?: AgentKitConfig\n): ResolvedAgentKitConfig {\n  if (!overrides) return base;\n  const next: ResolvedAgentKitConfig = {\n    payments: { ...base.payments },\n    wallet: { ...base.wallet },\n  };\n  assignDefined(next.payments, overrides.payments);\n  assignDefined(next.wallet, overrides.wallet);\n  return next;\n}\n\nfunction mergeRuntimeOverrides(\n  current: AgentKitConfig,\n  overrides: AgentKitConfig\n): AgentKitConfig {\n  const merged: AgentKitConfig = {\n    payments: { ...(current.payments ?? {}) },\n    wallet: { ...(current.wallet ?? {}) },\n  };\n  assignDefined(merged.payments!, overrides.payments);\n  assignDefined(merged.wallet!, overrides.wallet);\n  if (merged.payments && Object.keys(merged.payments).length === 0) {\n    delete merged.payments;\n  }\n  if (merged.wallet && Object.keys(merged.wallet).length === 0) {\n    delete merged.wallet;\n  }\n  return merged;\n}\n\nexport function configureAgentKit(overrides: AgentKitConfig) {\n  runtimeOverrides = mergeRuntimeOverrides(runtimeOverrides, overrides);\n}\n\nexport function resetAgentKitConfigForTesting() {\n  runtimeOverrides = {};\n}\n\nexport function getAgentKitConfig(): ResolvedAgentKitConfig {\n  const withEnv = applyOverrides(defaultConfig, environmentConfig);\n  return applyOverrides(withEnv, runtimeOverrides);\n}\n\nexport const defaults = {\n  facilitatorUrl: DEFAULT_FACILITATOR_URL,\n  payTo: DEFAULT_PAYMENT_WALLET_ADDRESS,\n  network: DEFAULT_NETWORK,\n  agentApiBaseUrl: DEFAULT_AGENT_API_BASE_URL,\n} as const;\n","import { z } from \"zod\";\nimport type { PaymentsConfig } from \"../types\";\nimport { getAgentKitConfig } from \"../config\";\n\nexport type Hex = `0x${string}`;\n\nexport const ZERO_ADDRESS: Hex = \"0x0000000000000000000000000000000000000000\";\n\nexport function normalizeDomain(domain: string): string {\n  return domain?.trim?.().toLowerCase?.() ?? \"\";\n}\n\nexport function normalizeAddress(value: string | null | undefined): Hex {\n  if (!value) {\n    throw new Error(\"invalid hex address\");\n  }\n  const trimmed = value.trim();\n  if (!/^0x[0-9a-fA-F]{40}$/.test(trimmed)) {\n    throw new Error(`invalid hex address: ${value}`);\n  }\n  return trimmed.toLowerCase() as Hex;\n}\n\nexport function sanitizeAddress(value: string | null | undefined): Hex {\n  if (!value) return ZERO_ADDRESS;\n  try {\n    return normalizeAddress(value);\n  } catch {\n    return ZERO_ADDRESS;\n  }\n}\n\nexport function toJsonSchemaOrUndefined(s?: z.ZodTypeAny) {\n  if (!s) return undefined;\n  try {\n    return z.toJSONSchema(s);\n  } catch {\n    return undefined;\n  }\n}\n\nexport function paymentsFromEnv(params?: {\n  defaultPrice?: string;\n}): PaymentsConfig {\n  const { payments } = getAgentKitConfig();\n  return {\n    payTo: payments.payTo,\n    facilitatorUrl: payments.facilitatorUrl,\n    network: payments.network,\n    defaultPrice: params?.defaultPrice ?? payments.defaultPrice,\n  };\n}\n"]}